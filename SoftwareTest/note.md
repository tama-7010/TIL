# ソフトウェアテスト技法ドリル

## 点に注意を向ける

### ピンポイントテスト
1. 怪しい箇所の認識…三色ボールペンを用いる(赤色…重要な箇所/青色…まぁ重要な箇所/緑色…自分が怪しいと感じたところ)
2. 間→対称→類推→外側を考える
3. 意地悪条件を考える…異常値/特異値/過去のバグやトラブル

### 過去の経験を活かす
#### バグパターン蓄積のトレーニング
* 多くのバグ票を読み込む…バグの原因が書いていないバグ票はほとんど役に立たない。バグの原因を読んで「どうしてそのようなバグを作り込んでしまったのだろう？」と想像することが良い訓練になる。
* 探索的テスト…テストをいているなかで怪しそうなところを重点的に探索し、深くテストしていく。テストの記録をとり、テスト終了後には、テスター自身にソフトウェアに対する印象をまとめて文書化してもらう。

## 線を意識する

### 同値分割と境界値分析の基本
* 同値分割…入力される可能性のあるデータをグループ化してその代表となる値を選びそれだけをテストする
  * 同値クラス…同値分割した各々のグループのこと
* 境界値分析…同値クラスの代表をそれぞれの端の値から選ぶこと
  * 境界値分析で大切なことは、簡単そうに思えても必ず線と丸を描いて同値クラスと無効同値クラスの違いを視覚的にわかるようにすること
  * 実数値の境界値分析は「65 - d(d = 0.0001)」のように定義する

### 同値分割と境界値分析の応用
* 有効な値（正常系）は複数同時に確認できるが、無効な値（異常系）については1回に1つずつしか確認できない（*異常値は他の異常値を隠す*）


## 面で逃さない

ソフトウェアはデータからなるものではなく、ロジック（論理）の塊から構成されている  
ロジックとは、入力の組み合わせによる特別な動作のこと  
したがって、ソフトウェアの入力が系統的にロジックを網羅し、正しく動作することをテストするテクニックを身につける必要がある

### ドメイン分析テスト

ドメイン分析テスト…関係性がある複数の変数を同時にテストする  
* on…着目している境界値
* off…onポイントに対して境界値分析をした時に見つかる、隣接したもう一つの境界値のこと
* in…ドメインの内側の値(on/off以外)
* out…ドメインの外側の値(on/off以外)
  
多くの変数があった場合は、着目する一つの変数についてonとoffを変化させ、他の値についてはinにしておけばその変数のon/offポイントを確実に評価することができる  
なぜなら、無効な値（異常系）については1回に1つずつしか確認できないから

参照---Binderのドメイン分析テストマトリクス

### デシジョンテーブル

デシジョンテーブルで取り扱う変数は主に論理式で結ばれている。プログラムの中のif文やswitch文は全てデシジョンテーブルにできる  
条件をnとすると規則の個数は2のn乗となり、全てをテストすることはできないので、デシジョンテーブルを圧縮する必要がある  

* 同じ動作（結果）を持つテストケースの中で、結果に影響を及ぼす行が最終行の「Y」と「N」の違いのみの場合、その列をまとめて結果を「-」に変更する

### 原因結果グラフ

条件が6個以上になってくるとデシジョンテーブルはとても大きくなってしまう  
ブールグラフから単純なデシジョンテーブルを作成するというアイデアを「原因結果グラフ」と呼ぶ  

#### 原因結果グラフの描き方

原因結果グラフは次のステップで作成する
1. 原因と結果の因果関係の抽出
2. ノードの配置とリンク
3. 制約条件の書き込み

##### 原因と結果の因果関係の抽出

原因結果グラフを描くためには、仕様書から因果関係を抽出する必要がある  
> ソフトウェア開発は複雑で解くことが難しい問題をできるだけシンプルな問題に分解し再構築する作業と見ることができる

*論理関係を示す用語の抽出*  
論理関係を記述するために使われる単語に三色ボールペンの青でマークをつけていく

*ノードの配置とリンク*
論理関係が抽出できたら、次は原因・中間・結果ノードを配置し、それらをリンクで繋げ、ノード間の関係を表す「AND」、「OR」、「NOT」をを書き込む

*制約条件の書き込み*
最後に制約条件を書き込み、原因結果ブラフを完成させる

##### 制約の詳細

原因結果グラフはAND、OR、NOTで成り立っているが、それだけでは複雑な仕様を表すのに手間がかかるので、補助的に論理関係を追加する制約という仕組みを持っている  
制約には大きく分けて「集合を表す制約」と「順序を表す制約」の2通りがある  

*集合を表す制約*
1. ONE制約…Only Oneの略。どれか一つを必ず選択する場合に使用する
2. EXCL制約…Exclusiveの略。どれか一つを選択するか、全く選択しない場合に使用する。選択しても高々ひとつ
3. INCL制約…Inclusiveの略。少なくとも一つは選択する場合に使用する。逆にいうと、全く選択しないことを許さない

*順序を表す制約*
1. REQ制約…Requireの略。あるノードが真になるために、事前に真になっている必要があるノードを指定する
2. MASK制約…あるノードが真になると、Mask制約で指定された2つ目以降のノードは審議が確認できないことを表す

#### 原因結果グラフからデシジョンテーブルへの変換
原因結果グラフからデシジョンテーブルへの変換は機械的に行うことができるが、複雑で手間がかかる  
加瀬正樹氏が作成した「CEGTest」というツールで作成する

### CFD法

CFD法…「原因の集合」と「原因同士の繋がり」に着目し「流れ線」でつなぐことによって仕様を図式化し、そこからデシジョンテーブルを作成する技法  

原因結果グラフと異なり、処理の流れ（Flow）が必要となるので、「実装仕様」を理解する必要がある  
もっとも実装前にCFD法を用いて処理の流れを詳細に設計したのちに、テストで同じCFD法で作られたデシジョンテーブルを使うようにすれば設計自体の品質も上がり、一石二鳥になる（これを検証指向設計設計と呼ぶ）  

CFD法では原因を集合で表現することで明示的に補集合についてテストの視点が届くことが特徴の一つ  
仕様書を文章で作成するときには「それ以外」（補集合）の存在については検討不十分のままになってしまうことも多い
CFD法を使用することにで仕様がより明確に図式化される

## 立体で捉える

### HAYST法
HAYST法は、直交表を用いた組み合わせテスト技法

#### HAYST法を使う意義
選択する技法によって組み合わせテストの項目は、大きく変化する  
HAYST法とペアワイズの使い分けは、次のことから判断する  
これらが重要な場合はHAYST法を選択するとよい
 * 3因子以上の組み合わせをバランスよく網羅的に多く出したい
 * テスト項目数をコントロールしたい
 * テスト結果を統計的に数値解析する必要がある
 * 複雑な禁則関係がある
 * テスト結果からバグの原因究明をしたい
 * ハードウェアの因子などによって同じ組み合わせをテストしてもバグが出たりでなかったりする
 
また、これらがテスト設計に重要でない場合はペアワイズ法を選択する
 * 単純な禁則しか存在しない
 * 小さな因子（4水準以内）が多数存在する

#### 因子と水準の抽出

まずGUIから得られる情報を整理する（関連する機能など）


その後6W2Hで考える（When, Who, Where, What, Why, How, How much, Whom）  
これらを考えることが「顧客視点」でソフトウェアを見ることに繋がる  
大切なことは、検討中は「そんなの関係ないだろう」と切り捨てないこと  
KJ法やブレーンストーミングのように、否定や批判は後にして、まずは思いつくままに因子や水準を列挙する

##### （1）When、Where、Whoについて考える

これらは当該ソフトウェアを使用するときのユーザーシーンを定義する
 * When…いつ使われるか
 * Where…どのシーンで使われるか
 * Who…自分を中心にして極端な人を想像する

##### （2）What、Why、Whomについて考える

 * What…仕様。仕様書やマニュアル、ヘルプを読み直してみる
 * Why…要求。その機能を搭載した理由や要求を引き出す
 * Whom…問題。要求の背景にある当該ソフトウェアが解決すべき問題をあぶり出す

##### （3）How、How muchについて考える

 * How…設計。仕様をコンピュータ上に効率よく実装するために考慮したこと（アルゴリズムやクラス設計など）
 * How much…価格/量。このソフトウェアが販売される価格に対する顧客の期待レベルを考える/大量、少量の場合を考える

#### FV表

FV表とはFunction Verification Tableの略で、テスト分析結果をまとめるための表になる

##### （1）No.
No.を仕様書の章・節と対応させる  
仕様書とFV表をNo.列でリンクすれば仕様をテストへ反映していることの確認が楽になる

##### （2）目的機能（Fr）
 1. テスト対象のソフトウェアの機能仕様書を開き、「機能」を取り出す
 2. その機能が持っている目的について考え、それを目的機能列に記入する。ユーザーが求める「正しい動作」をすることを確認しなければならない
